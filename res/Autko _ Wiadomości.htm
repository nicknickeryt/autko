<!DOCTYPE html>
<!-- saved from url=(0047)http://localhost:8080/autko/messenger/?userid=2 -->
<html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <link rel="icon" type="image/x-icon" href="http://localhost:8080/autko/res/favicon.ico">
    <title>
      Autko | Wiadomości
    </title>
    <!-- Required meta tags -->
    
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="./Autko _ Wiadomości_files/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
    <link rel="stylesheet" href="./Autko _ Wiadomości_files/messenger.css">

<link rel="stylesheet" href="./Autko _ Wiadomości_files/all.min.css" integrity="sha512-KfkfwYDsLkIlwQp6LFnl8zNdLGxu9YAA1QvwINks4PhcElQSvqcyVLLD9aMhXd13uQjoXtEKNosOWaZqXgel0g==" crossorigin="anonymous" referrerpolicy="no-referrer">
<link rel="stylesheet" href="./Autko _ Wiadomości_files/solid.min.css" integrity="sha512-qzgHTQ60z8RJitD5a28/c47in6WlHGuyRvMusdnuWWBB6fZ0DWG/KyfchGSBlLVeqAz+1LzNq+gGZkCSHnSd3g==" crossorigin="anonymous" referrerpolicy="no-referrer">
</head>

<body>
  <script src="./Autko _ Wiadomości_files/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script src="./Autko _ Wiadomości_files/jquery-3.6.0.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script>
  <script src="./Autko _ Wiadomości_files/messenger.js">
  </script>

  <div class="d-flex page">


          <div class="d-flex kontener">
    <nav class="navbar navbar-expand-lg navbar-light bg-light">
        <div class="container-fluid">
          <a class="navbar-brand" href="http://localhost:8080/autko/">
          <img src="./Autko _ Wiadomości_files/whiteweb.png" alt="" height="64">
        </a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>
 <div class="collapse navbar-collapse justify-content-between" id="navbarSupportedContent">
                <div class="navbar-nav ml-auto">
                    <a href="http://localhost:8080/autko/oferta" data-toggle="collapse" class="nav-item hvr-ripple-in whitetext nav-link text-uppercase font-weight-bold"><span>OFERTA</span></a>
                    <a href="http://localhost:8080/autko/ogloszenia" data-toggle="collapse" class="nav-item hvr-ripple-in whitetext nav-link text-uppercase font-weight-bold"><span>OGŁOSZENIA</span></a>
                    <a href="http://localhost:8080/autko/onas" data-toggle="collapse" class="nav-item hvr-ripple-in whitetext nav-link text-uppercase font-weight-bold"><span>O NAS</span></a>
                  </div>

              <div class="navbar-nav navbar-right">
                  
                      <div class="nav-item dropdown">
                      <a class="nav-link hvr-ripple-in whitetext dropdown-toggle" href="http://localhost:8080/autko/messenger/?userid=2#" id="navbarDropdownMenuLink" role="button" data-bs-toggle="dropdown" aria-expanded="false">
                                adadsada
                              </a>
                              <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdownMenuLink">
                                <li><a class="dropdown-item" href="http://localhost:8080/autko/profile">Profil</a></li>
                                <li><a class="dropdown-item" href="http://localhost:8080/autko/messenger/?userid=2#">Wiadomości</a></li>
                                <li><a class="dropdown-item" href="http://localhost:8080/autko/cart">Koszyk</a></li>
                                <li><a class="dropdown-item" href="http://localhost:8080/autko/login/logout.php">Wyloguj</a></li>
                              </ul>
                      </div>                </div>
              </div>
            </div>
          </nav>


    <div class="input-group">
      <div id="myDropdown">
        <div class="d-flex justify-content-between">
        <input type="search" id="myInput" autocomplete="off" class="form-control hvr-ripple-in" placeholder="Szukaj" onkeyup="filterFunction()">

<div class="container align-self-center">
<div class="card receiver hvr-ripple-in d-flex flex-row justify-content-center align-items-center">

<img src="./Autko _ Wiadomości_files/default.svg" class="card-img-top userimage align-self-center" alt="">
  <div class="card-body"><h5 class="card-title username-label">dbashdbasd</h5>

</div></div>
 </div>

<ul class="row-fluid container list-group lista" style="display: none;">




<li class="list-group-item flex-row userlist">
<img src="./Autko _ Wiadomości_files/default.svg" class="card-img-top userimage-list align-self-center" alt="">
<a class="user-a border-0 list-group-item" style="" onclick="window.location.href=&quot;../messenger/?userid=2&quot;">dbashdbasd
</a>
</li></ul>

</div>
</div>
</div>
<div class="container flex-column d-flex message-box">

<p class="message message-to text-decoration-none">esfsfesfs</p><p class="message message-to text-decoration-none">aaaaaaaaaaa</p><p class="message bg-primary message-from text-decoration-none" data-id="3">efesfes</p><p class="message bg-primary message-from text-decoration-none" data-id="4">eafaefeaf</p><p class="message bg-primary message-from text-decoration-none" data-id="5">efesfeafa</p><p class="message message-to text-decoration-none">siema</p>

</div>

<footer class="mt-auto send-form">
<div class="container input-group mb-3">
 <input type="text" class="send form-control" placeholder="Wpisz wiadomość..." aria-label="Recipient&#39;s username" aria-describedby="button-addon2">
 <button class="sendbtn btn btn-outline-secondary" onclick="sendMess();" type="button" id="button-addon2"><i class="fa-solid fa-paper-plane"></i></button>
</div>
</footer>


</div>
</div>

<script>
$('.message-box').scrollTop($('.message-box')[0].scrollHeight);





$(document).click(function() {
  console.log('clicked outside');
  $(".lista").hide();
});

$("#myInput").click(function(event) {
  console.log('clicked inside');
  $(".lista").show();
  filterFunction();
  event.stopPropagation();
});

$(".lista").click(function() {
console.log($(this).text());
});

function filterFunction() {
var input, filter, ul, li, a, i;
input = document.getElementById("myInput");
filter = input.value.toUpperCase();
div = document.getElementById("myDropdown");
a = div.getElementsByTagName("a");
for (i = 0; i < a.length; i++) {
  txtValue = a[i].textContent || a[i].innerText;
  if (txtValue.toUpperCase().indexOf(filter) > -1) {
    $(a[i]).show();
  } else {
    $(a[i]).hide();
  }
}
}



function sendMess() {
console.log("aaaa");
if ($(".send").val() == "") {
  return;
}
$.ajax({
  url: "../profile/upload.php?message=" + $(".send").val() + "&senderid=" + 1 + "&receiverid=" + 2,
  type:'HEAD',
  success: function()
  {
      console.log("sukces");
  }
});
$(".message-box").append("<p class='message message-to text-decoration-none'>" + $(".send").val() + "</p>");
$(".send").val("");
$('.message-box').scrollTop($('.message-box')[0].scrollHeight);
}

$.ajax({
url: "../res/profpic/1.png?1654163576",
type:'HEAD',
success: function()
{
      $(".userimage").attr("src", "../res/profpic/" + "default.svg");

}
});


if(1 == "0") {
 $(".sendbtn").addClass("disabled");
}

if(1 == "0")



  setInterval(function(){
  }, 5000);


function refresh() {

    var lastmessage = $(".message-from").last().data("id");
    var newmessage = lastmessage;

    console.log("sprawdzam..");

    $.ajax({
    url: "refresh.php?senderid=" + 2 + "&receiverid=" + 1,
    type:'POST',
    success: function( data )
    {


      console.log("tescik: " + data + " last: " + lastmessage)
      var newmessage = data;


          console.log(newmessage > lastmessage);
          console.log("new: " + newmessage + " last: " + lastmessage);

      if(newmessage > lastmessage){

        $.ajax({
        url: "newmessage.php?id=" + newmessage,
        type:'POST',
        success: function( content )
        {
                 $(".message-box").append($("<p class='message bg-primary message-from text-decoration-none' data-id='" + newmessage +   "'>" + content +  "</p>"));
        }});


        lastmessage = newmessage;
        $(".message-box").animate({ scrollTop: $('.message-box').prop("scrollHeight")}, 1000);
      }
    }});


}


if(1 == 1) {
var myInterval = setInterval(refresh, 1000);
}

$(".receiver").click(function(){
  location.href = "../profile/u?u=" + 2});

</script>



</body></html>